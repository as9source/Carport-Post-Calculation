<script>
(function(){
  const lEl = document.getElementById("hole_l");
  const wEl = document.getElementById("hole_w");
  const hEl = document.getElementById("hole_h");
  const aEl = document.getElementById("post_a");
  const bEl = document.getElementById("post_b");
  const nEl = document.getElementById("posts");
  const out = document.getElementById("out");

  let wManual = false; // Wを手動入力したか
  let bManual = false; // bを手動入力したか

  const toNum = el => { const v = Number(el.value); return (Number.isFinite(v) && v >= 0) ? v : 0; };
  const mm3_to_m3 = v => v / 1_000_000_000;

  // --- L→W（手動書き換えされるまで常に同期） ---
  lEl.addEventListener("input", ()=>{
    if(!wManual){
      wEl.value = lEl.value;
    }
  });
  wEl.addEventListener("input", ()=>{ wManual = true; });

  // --- a→b（手動書き換えされるまで常に同期） ---
  aEl.addEventListener("input", ()=>{
    if(!bManual){
      bEl.value = aEl.value;
    }
  });
  bEl.addEventListener("input", ()=>{ bManual = true; });

  function calc(){
    const L = toNum(lEl), W = toNum(wEl), H = toNum(hEl);
    const a = toNum(aEl), b = toNum(bEl), N = toNum(nEl);

    const V_hole = L * W * H;
    const V_post = a * b * H;
    const V1 = Math.max(0, V_hole - V_post);

    const m3_1 = mm3_to_m3(V1);
    const m3_T = m3_1 * N;

    out.innerHTML =
      `<strong>穴1つ分：</strong> ${m3_1.toFixed(3)} m³<br>` +
      `<strong>全部（${N}本）：</strong> ${m3_T.toFixed(3)} m³`;
  }

  document.getElementById("calcBtn").addEventListener("click", calc);
  document.getElementById("backBtn").addEventListener("click", ()=>{ location.href = "index.html"; });
})();
</script>
