<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã‚«ãƒ¼ãƒãƒ¼ãƒˆæŸ±å¯¸æ³•è¨ˆç®—ï¼ˆè£½å“é¸æŠï¼‹æ‰‹å‹•ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="popup.css" rel="stylesheet">
  <script src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
  <img src="banner.png" alt="ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒŠãƒ¼" style="width: 100%; margin-bottom: 8px;" />

  <div style="text-align: right; font-size: 13px; margin-bottom: 8px;">
    <a href="usage.html" target="_blank">â–¶ ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</a>
  </div>

  <div id="result" style="margin-bottom: 16px;"></div>

  <h2>ã‚«ãƒ¼ãƒãƒ¼ãƒˆæŸ±å¯¸æ³•è¨ˆç®—</h2>

  
    <div id="modeTabs" style="margin-bottom: 12px; display: flex; border-bottom: 2px solid #ccc;">
      <div id="tabAuto" style="flex: 1; text-align: center; padding: 8px; cursor: pointer; background: #eee; border: 1px solid #ccc; border-bottom: none;">è£½å“é¸æŠãƒ¢ãƒ¼ãƒ‰</div>
      <div id="tabManual" style="flex: 1; text-align: center; padding: 8px; cursor: pointer; border: 1px solid #ccc; border-left: none; border-bottom: none;">æ‰‹å‹•å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰</div>
    </div>
    
    
    
  </div>

  <div id="autoSection">
    <label>è£½å“å</label>
    <select id="typeSelector"><option value="">--é¸æŠ--</option></select><br>

    <label>å…¨é•·</label>
    <select id="sizeSelector"><option value="">--é¸æŠ--</option></select><br>

    <label>æŸ±æœ¬æ•°</label>
    <select id="postCount"><option value="">--é¸æŠ--</option></select><br>
  </div>

  <div id="manualSection" style="display:none;">
    <label>æŸ±æœ¬æ•°ï¼ˆæ‰‹å‹•ï¼‰</label>
    <select id="manualPostCount">
      <option value="">--é¸æŠ--</option>
      <option value="2">2æœ¬</option>
      <option value="3">3æœ¬</option>
      <option value="4">4æœ¬</option>
    </select><br>
  </div>

  <label>L1</label>
  <input type="number" id="l1"><br>
  <label>L2</label>
  <input type="number" id="l2"><br>
  <label>L3</label>
  <input type="number" id="l3"><br>
  <label>åŠ å·¥å¾Œã®å…¨é•·ï¼ˆLâ€™ï¼‰</label>
  <input type="number" id="newLength"><br><br>

  <button id="calcBtn">è¨ˆç®—</button>

  <p style="text-align: right; font-size: 12px; color: #888;">
    ğŸ†• ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼šv1.3ï¼ˆæœ€çµ‚æ›´æ–°ï¼š2025/04/18ï¼‰ï¼ˆæœ€çµ‚æ›´æ–°ï¼š2025/04/18ï¼‰
  </p>

  <script src="popup.js"></script>
  <script src="sheet_loader.js"></script>
  <script>

    const tabAuto = document.getElementById("tabAuto");
    const tabManual = document.getElementById("tabManual");

    function setMode(mode) {
      if (mode === "auto") {
        document.getElementById("autoSection").style.display = "block";
        document.getElementById("manualSection").style.display = "none";
        tabAuto.style.background = "#eee";
        tabManual.style.background = "#fff";
        tabAuto.style.fontWeight = "bold";
        tabManual.style.fontWeight = "normal";
      } else {
        document.getElementById("autoSection").style.display = "none";
        document.getElementById("manualSection").style.display = "block";
        tabAuto.style.background = "#fff";
        tabManual.style.background = "#eee";
        tabManual.style.fontWeight = "bold";
        tabAuto.style.fontWeight = "normal";
      }
    }

    tabAuto.onclick = () => setMode("auto");
    tabManual.onclick = () => setMode("manual");

    // åˆæœŸåŒ–
    setMode("auto");
    </script>
  <script>
    // ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿å‡¦ç†
    const modeRadios = document.querySelectorAll('input[name="mode"]');
    const autoSection = document.getElementById("autoSection");
    const manualSection = document.getElementById("manualSection");
    const postCountAuto = document.getElementById("postCount");
    const postCountManual = document.getElementById("manualPostCount");

    modeRadios.forEach(radio => {
      radio.addEventListener("change", () => {
        const mode = document.querySelector('input[name="mode"]:checked').value;
        if (mode === "auto") {
          autoSection.style.display = "block";
          manualSection.style.display = "none";
        } else {
          autoSection.style.display = "none";
          manualSection.style.display = "block";
        }
      });
    });

    // è¨ˆç®—ãƒœã‚¿ãƒ³ã®æ©Ÿèƒ½åˆ‡æ›¿
    document.getElementById("calcBtn").addEventListener("click", () => {
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const l1 = parseFloat(document.getElementById("l1").value) || 0;
      const l2 = parseFloat(document.getElementById("l2").value) || 0;
      const l3 = parseFloat(document.getElementById("l3").value) || 0;
      const newLength = parseFloat(document.getElementById("newLength").value) || 0;

      const postCount = mode === "auto"
        ? parseInt(postCountAuto.value) || 0
        : parseInt(postCountManual.value) || 0;

      const resultDiv = document.getElementById("result");

      if (!postCount || newLength === 0 || (l1 + l2 + l3) === 0) {
        resultDiv.innerHTML = "<p style='color:red;'>ã™ã¹ã¦ã®å€¤ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>";
        return;
      }

      const originalSum = l1 + l2 * (postCount - 1) + l3;
      const ratio = newLength / originalSum;

      const newL1 = Math.round(l1 * ratio);
      const newL2 = Math.round(l2 * ratio);
      const newL3 = Math.round(l3 * ratio);
      const newSum = newL1 + newL2 * (postCount - 1) + newL3;

      resultDiv.innerHTML = `
        <div style="margin-bottom: 8px;">
          å…ƒã®å…¨é•·ï¼š${originalSum} mmã€€â€»å…¨é•·å¯¸æ³•ç¢ºèª
        </div>
        <div style="margin-bottom: 8px;">
          åŠ å·¥å¾Œã®åˆè¨ˆï¼š${newSum} mm
        </div>
        <div style="border: 1px solid #f33; padding: 8px; border-radius: 6px;">
          <strong>åŠ å·¥å¾Œã®L1ï¼š</strong> ${newL1} mm<br>
          <strong>åŠ å·¥å¾Œã®L2ï¼ˆÃ—${postCount - 1}ï¼‰ï¼š</strong> ${newL2} mm<br>
          <strong>åŠ å·¥å¾Œã®L3ï¼š</strong> ${newL3} mm
        </div>
      `;
    });
  </script>
</body>
</html>
